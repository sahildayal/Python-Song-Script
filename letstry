import pandas as pd

# Load Excel file
excel_file = "your_excel_file.xlsx"
df = pd.read_excel(excel_file)

# Mapping of Funding Type to Funding Type Code
funding_type_mapping = {
    'Community Rated': 'COM',
    'Experience Rated': 'EXP',
    'Level Funded': 'LVL',
    'Self Funded': 'SFD',
    'Reference Based Pricing': 'RBP',
    'Other': 'OTH',
    'Undefined': 'UND'
}

# Open SQL script file for writing
sql_script_file = "update_script.sql"
with open(sql_script_file, 'w') as sql_file:
    # Iterate over each row in the Excel file
    for index, row in df.iterrows():
        client_id = row['Client ID']
        subplan_code = row['Subplan Code']
        funding_type = row['Funding Type']

        # Check if the Funding Type is in the mapping
        if funding_type in funding_type_mapping:
            funding_type_code = funding_type_mapping[funding_type]

            # Generate SQL UPDATE statement
            sql_update = f"UPDATE lai.clt_subplan SET CS_FTR_CODE = '{funding_type_code}' WHERE CLIENT_ID = '{client_id}' AND CS_SUBPLAN_CODE = '{subplan_code}';\n"

            # Write SQL statement to file
            sql_file.write(sql_update)

print("SQL script generation completed.")
